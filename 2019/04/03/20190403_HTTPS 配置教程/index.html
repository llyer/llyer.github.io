<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>HTTPS 配置教程 | 李鲁杨的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本文将以本站 http://liluyang.me 升级到 https://liluyang.me 的过程来分享一下 https 的原理，http 和 https 的区别，以及如何将网站从 http 升级到 https。 引言为什么要用 https？https 更安全。甚至为了安全，一个专业可靠的网站， https 是必须的。 Firefox 和 Chrome 都计划将没有配置 SSL 加密的 h">
<meta name="keywords" content="Docker,Hexo,Nginx,计算机网络,博客,HTTPS">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTPS 配置教程">
<meta property="og:url" content="http://yoursite.com/2019/04/03/20190403_HTTPS 配置教程/index.html">
<meta property="og:site_name" content="李鲁杨的个人博客">
<meta property="og:description" content="本文将以本站 http://liluyang.me 升级到 https://liluyang.me 的过程来分享一下 https 的原理，http 和 https 的区别，以及如何将网站从 http 升级到 https。 引言为什么要用 https？https 更安全。甚至为了安全，一个专业可靠的网站， https 是必须的。 Firefox 和 Chrome 都计划将没有配置 SSL 加密的 h">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_01.gif">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_02.png">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_03.png">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_04.png">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_05.png">
<meta property="og:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_06.png">
<meta property="og:updated_time" content="2019-04-18T09:55:46.779Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTPS 配置教程">
<meta name="twitter:description" content="本文将以本站 http://liluyang.me 升级到 https://liluyang.me 的过程来分享一下 https 的原理，http 和 https 的区别，以及如何将网站从 http 升级到 https。 引言为什么要用 https？https 更安全。甚至为了安全，一个专业可靠的网站， https 是必须的。 Firefox 和 Chrome 都计划将没有配置 SSL 加密的 h">
<meta name="twitter:image" content="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_01.gif">
  
    <link rel="alternate" href="/atom.xml" title="李鲁杨的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">李鲁杨的个人博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-20190403_HTTPS 配置教程" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/03/20190403_HTTPS 配置教程/" class="article-date">
  <time datetime="2019-04-03T05:33:01.000Z" itemprop="datePublished">2019-04-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      HTTPS 配置教程
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文将以本站 <a href="http://liluyang.me" target="_blank" rel="noopener">http://liluyang.me</a> 升级到 <a href="https://liluyang.me" target="_blank" rel="noopener">https://liluyang.me</a> 的过程来分享一下 <code>https</code> 的原理，<code>http</code> 和 <code>https</code> 的区别，以及如何将网站从 <code>http</code> 升级到 <code>https</code>。</p>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><h2 id="为什么要用-https？"><a href="#为什么要用-https？" class="headerlink" title="为什么要用 https？"></a>为什么要用 <code>https</code>？</h2><p><code>https</code> 更安全。甚至为了安全，一个专业可靠的网站， <code>https</code> 是必须的。 <code>Firefox</code> 和 <code>Chrome</code> 都计划将没有配置 <code>SSL</code> 加密的 <code>https</code> 网站标记为不安全（貌似 <code>Firefox50</code> 已经这么干了），目前它们也正在联合其他相关的基金会与公司推动整个互联网 <code>https</code> 化，现在大家访问的一些主要的网站。如 <code>Google</code> 多年前就已经全部启用 <code>https</code> ，国内的淘宝、搜狗、知乎、百度等等也全面 <code>https</code> 了。甚至 <code>Google</code> 的搜索结果也正在给予 <code>https</code> 的网站更高的排名和优先收录权。</p>
<h2 id="要需要掌握哪些知识？"><a href="#要需要掌握哪些知识？" class="headerlink" title="要需要掌握哪些知识？"></a>要需要掌握哪些知识？</h2><p>拥有基础的 <code>Linux</code> 系统知识，常用的 <code>Shell</code> 命令。</p>
<h2 id="需要有什么资源？"><a href="#需要有什么资源？" class="headerlink" title="需要有什么资源？"></a>需要有什么资源？</h2><p>如果你只是要测试 <code>https</code>，请查看<a href="http://www.ruanyifeng.com/blog/2018/02/nginx-docker.html" target="_blank" rel="noopener">Nginx 容器教程</a></p>
<p>如果你要在生产环境使用 <code>https</code>，请接着往下看：</p>
<p>一个服务器，一个域名，并且已经正确的将域名指向了你的服务器，并且拥有服务器的 <code>SSH</code> 权限</p>
<p><code>Tips:</code> 需要注意的是如果是在国内阿里云或者腾讯云购买的域名请备案，否则即使你正确的配置了你的域名，可能也依然无法访问你的服务器，因为在国内备案是必须的。</p>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><h3 id="http-和-https"><a href="#http-和-https" class="headerlink" title="http 和 https"></a>http 和 https</h3><p>简单来说，<code>http</code> 是一个传输网页内容的协议，比如你看到的 <code>http</code> 开头的网站 <a href="http://www.163.com，其网页上的文字、图片、" target="_blank" rel="noopener">http://www.163.com，其网页上的文字、图片、</a> <code>CSS</code>、<code>JS</code> 等文件都是通过 <code>http</code> 协议传输到我们的浏览器，然后被我们看到。</p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_01.gif" alt=""></p>
<p>而 <code>https</code> 可以理解为 <code>HTTP over SSL/TLS</code> ，好端端的 <code>http</code> 为什么需要 <code>over SSL/TLS</code> 呢，因为 <code>http</code> 是明文传输的，通过 <code>http</code> 协议传输的内容很容易被偷看和篡改，为了安全（你肯定不想被人偷看或者篡改网页内容吧，比如网站银行密码什么的。）就为 <code>http</code> 协议再加上了一层 <code>SSL/TLS</code> 安全协议，所以就有了 <code>https</code>。</p>
<h3 id="SSL-TLS"><a href="#SSL-TLS" class="headerlink" title="SSL/TLS"></a>SSL/TLS</h3><p><code>HTTP over SSL/TLS</code> 字面意思就是带 <code>安全套接层</code> 的 <code>http</code> 协议，内心纯洁的同学也可以理解为 <code>带安全套的 http</code>，因为带了安全套，所以当然会比较安全（/(ㄒoㄒ)/~~）。其中 <code>SSL</code> 是 <code>Secure Sockets Layer</code> 的缩写，是 “安全套接层” 的意思。<code>TLS</code> 是 <code>Transport Layer Security</code> 的缩写，是 <code>传输层安全协议</code> 的意思。<code>SSL</code> 和 <code>TLS</code> 是同一个东西的不同阶段，理解为同一个东西也行，都是安全协议就对了。</p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_02.png" alt=""></p>
<h3 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h3><p>证书颁发机构（CA, Certificate Authority）即颁发数字证书的机构。是负责发放和管理数字证书的权威机构，并作为电子商务交易中受信任的第三方，承担公钥体系中公钥的合法性检验的责任。</p>
<h3 id="Let’s-Encrypt"><a href="#Let’s-Encrypt" class="headerlink" title="Let’s Encrypt"></a>Let’s Encrypt</h3><p><code>Let&#39;s Encrypt</code> 成立于 <code>2015</code> 年的数字证书认证机构，成立的目的就是为了推行 <code>https</code> 协议在全世界的普及。主要赞助商包括电子前哨基金会、Mozilla基金会、Akamai以及思科。<code>Let&#39;s Encrypt</code> 旨在以自动化流程消除手动创建和安装证书的复杂流程，并推广使万维网服务器的加密连接无所不在，为安全网站提供免费的 <code>SSL/TLS</code> 证书。</p>
<p>说人话就是 <code>Let’s Encrypt</code> 就是一个可以给我们颁发授信证书的 <code>CA</code> 组织。</p>
<h3 id="Certbot"><a href="#Certbot" class="headerlink" title="Certbot"></a>Certbot</h3><p><code>Let’s Encrypt</code> 官方推出的授信证书生成客户端。可以在 <code>Debian</code>，<code>CentOS</code> 等主流系统上运行</p>
<p>官方链接如下：<a href="https://certbot.eff.org/" target="_blank" rel="noopener">https://certbot.eff.org/</a></p>
<h1 id="获取证书"><a href="#获取证书" class="headerlink" title="获取证书"></a>获取证书</h1><p>要升级到 <code>https</code> 首先要获得 <code>CA</code> 签发的安全证书文件，我们选择的证书签发机构是 <code>Let’s Encrypt</code>，目前 <code>Let’s Encrypt</code> 推荐的方法是安装 <code>Certbot</code> 工具通过校验服务器和域名的归属权方式来获取证书</p>
<h2 id="安装Certbot"><a href="#安装Certbot" class="headerlink" title="安装Certbot"></a>安装Certbot</h2><p>如果你的英文能力比较好，那么请访问 <a href="https://certbot.eff.org/" target="_blank" rel="noopener">Certbot官网</a> 根据官方教程来下载，官方教程更加细致，出了问题也方便查看官方的第一手资料。当然你也可以根据以下命令来安装 <code>Certbot</code> 工具，这里我们以 <code>debian9</code> 系统为例来安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 certbot，如果是 centOS 等内核，可以使用 yum 命令</span></span><br><span class="line">apt install certbot</span><br></pre></td></tr></table></figure>
<h2 id="生成证书"><a href="#生成证书" class="headerlink" title="生成证书"></a>生成证书</h2><p><code>certbot</code> 安装成功后，我们有两种模式来获取证书</p>
<h3 id="第一种模式-Webroot"><a href="#第一种模式-Webroot" class="headerlink" title="第一种模式 Webroot"></a>第一种模式 Webroot</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot certonly --webroot -w /root/docker_nginx/html -d liluyang.me -d www.liluyang.me</span><br></pre></td></tr></table></figure>
<p>这个命令会为 <code>liluyang.com</code> 和 <code>www.liluyang.com</code> 这两个域名生成一个证书</p>
<p><code>--webroot</code> 模式会在 <code>/root/docker_nginx/html</code> 中创建 <code>.well-known</code>文件夹，这个文件夹里面包含了一些验证文件，<code>certbot</code> 会通过访问 <code>example.com/.well-known/acme-challenge</code> 来验证你的域名是否绑定的这个服务器。这个文件夹就是你 <code>Nginx</code> 下 <code>index.html</code> 所在的目录，请自行根据自己服务器 <code>Nginx</code> 的配置情况修改这个参数。</p>
<p>如果执行成功，命令行会大致输出以下参数表示成功：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">IMPORTANT NOTES:</span><br><span class="line"> - Congratulations! Your certificate and chain have been saved at:</span><br><span class="line">   /etc/letsencrypt/live/liluyang.me/fullchain.pem</span><br><span class="line">   Your key file has been saved at:</span><br><span class="line">   /etc/letsencrypt/live/liluyang.me/privkey.pem</span><br><span class="line">   Your cert will expire on 2019-07-01. To obtain a new or tweaked</span><br><span class="line">   version of this certificate <span class="keyword">in</span> the future, simply run certbot</span><br><span class="line">   again. To non-interactively renew *all* of your certificates, run</span><br><span class="line">   <span class="string">"certbot renew"</span></span><br><span class="line"> - If you like Certbot, please consider supporting our work by:</span><br><span class="line"></span><br><span class="line">   Donating to ISRG / Let<span class="string">'s Encrypt:   https://letsencrypt.org/donate</span></span><br><span class="line"><span class="string">   Donating to EFF:                    https://eff.org/donate-le</span></span><br></pre></td></tr></table></figure>
<p>以上信息中包含了生成后的证书的位置，过期时间等信息，根据提示信息我们打开 <code>/etc/letsencrypt/live/</code> 文件夹，检查这个文件夹中是否有你生成的对应网站的证书文件，如果成功，应该如下图所示：</p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_03.png" alt=""></p>
<p>这个命令在大多数情况下都可以满足需求，如果失败了，请看下一种模式。</p>
<h3 id="第二种模式-Standalone"><a href="#第二种模式-Standalone" class="headerlink" title="第二种模式 Standalone"></a>第二种模式 Standalone</h3><p>如果你已经通过第一种模式生成证书成功，请跳过这里，直接看下一章</p>
<p>但是有些时候我们的一些服务并没有根目录，例如一些微服务，这时候使用 <code>--webroot</code> 就走不通了。<code>certbot</code> 还有另外一种模式 <code>--standalone</code>， 这种模式不需要指定网站根目录，他会自动启用服务器的 <code>443</code> 端口，来验证域名的归属。我们有其他服务（例如nginx）占用了 <code>443</code> 端口，就必须先停止这些服务，在证书生成完毕后，再启用。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot certonly --standalone -d example.com -d www.example.com</span><br></pre></td></tr></table></figure>
<p>证书生成完毕后，我们可以在 <code>/etc/letsencrypt/live/</code> 目录下看到对应域名的文件夹，里面存放了指向证书的一些快捷方式。</p>
<p>这时候我们的第一生成证书已经完成了，接下来就是配置我们的 <code>web</code> 服务器，启用 <code>HTTPS</code>。</p>
<p><strong>如果生成失败，并且你自己搜索之后又没有能力解决，请在评论留言</strong></p>
<p><strong>如果生成失败，并且你自己搜索之后又没有能力解决，请在评论留言</strong></p>
<p><strong>如果生成失败，并且你自己搜索之后又没有能力解决，请在评论留言</strong></p>
<h1 id="安装证书"><a href="#安装证书" class="headerlink" title="安装证书"></a>安装证书</h1><p>证书生成生成后，我们还要做最后的一步就是把证书的配置信息添加到 <code>nginx</code> 的 <code>conf</code> 目录的 <code>certs</code> 文件夹中。我个人的 <code>Nginx</code> 是通过 <code>docker</code> 镜像的方式运行的，并且我将本地的 <code>/root/docker_nginx/conf</code> 文件夹设置为了 <code>Nginx</code> 的配置文件夹，所以现在我们将证书 <code>cert.pem</code> 和 <code>privkey.pem</code> 拷贝到这个目录。配置目录如下</p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_04.png" alt=""></p>
<p>在 <code>Nginx</code> 的配置文件 <code>nginx.conf</code> 末尾添加以下配置，注意修改对应的配置参数，下面的配置模板仅供参考。</p>
<p>如果存在 <code>conf.d/default.conf</code> 文件请优先修改此文件，具体原因请百度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 443 https 配置</span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl http2;</span><br><span class="line">    server_name  liluyang.me www.liluyang.me;</span><br><span class="line"></span><br><span class="line">    ssl                      on;</span><br><span class="line">    ssl_certificate          /etc/nginx/certs/cert.pem;</span><br><span class="line">    ssl_certificate_key      /etc/nginx/certs/privkey.pem;</span><br><span class="line"></span><br><span class="line">    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_protocols SSLv3 TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers   on;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>重启 Nginx</strong></p>
<p>到此为止，我们就已经成功的完成了 <code>https</code> 的配置。 现在打开我的博客 <a href="https://liluyang.com" target="_blank" rel="noopener">https://liluyang.com</a> 就可以在浏览器端看到标有 <code>安全</code> 的网站标识字样了，如下图：</p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_05.png" alt=""></p>
<p><img src="https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190403_https_06.png" alt=""></p>
<h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><p>如果是 <code>docker</code> 部署的 <code>nginx</code>，最后重启启动 <code>docker</code> 时要将 <code>443（https）</code> 端口映射出来，否则无法访问服务器的 <code>443（https）</code> 端口的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  --volume &quot;$PWD/html&quot;:/usr/share/nginx/html \</span><br><span class="line">  --volume &quot;$PWD/conf&quot;:/etc/nginx \</span><br><span class="line">  -p 80:80 \</span><br><span class="line">  -p 443:443 \</span><br><span class="line">  -d \</span><br><span class="line">  nginx</span><br></pre></td></tr></table></figure></p>
<h1 id="可选配置"><a href="#可选配置" class="headerlink" title="可选配置"></a>可选配置</h1><h2 id="强制使用-https-访问网站"><a href="#强制使用-https-访问网站" class="headerlink" title="强制使用 https 访问网站"></a>强制使用 https 访问网站</h2><p>将 <code>http</code> 请求转发到 <code>https</code></p>
<p>请在配置文件夹中添加以下配置，然后重启 <code>Nginx</code> 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name liluyang.me www.liluyang.me;</span><br><span class="line">    return 301 https://liluyang.me;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自动续订"><a href="#自动续订" class="headerlink" title="自动续订"></a>自动续订</h2><p>细心的同学可能会发现， <code>https</code> 证书的有效时间是非常短的，只有三个月，那么每隔三个月我们都要操作一次吗？其实不是的，我们可以用过自动续订的方式来刷新我们的证书有效时间。</p>
<h3 id="测试自动续订"><a href="#测试自动续订" class="headerlink" title="测试自动续订"></a>测试自动续订</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot renew --dry-run</span><br></pre></td></tr></table></figure>
<p>如果测试成功，会生成如下提示：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Saving debug <span class="built_in">log</span> to /var/<span class="built_in">log</span>/letsencrypt/letsencrypt.log</span><br><span class="line"></span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">Processing /etc/letsencrypt/renewal/liluyang.me.conf</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">Cert not due <span class="keyword">for</span> renewal, but simulating renewal <span class="keyword">for</span> dry run</span><br><span class="line">Plugins selected: Authenticator webroot, Installer None</span><br><span class="line">Renewing an existing certificate</span><br><span class="line">Performing the following challenges:</span><br><span class="line">http-01 challenge <span class="keyword">for</span> liluyang.me</span><br><span class="line">http-01 challenge <span class="keyword">for</span> www.liluyang.me</span><br><span class="line">Waiting <span class="keyword">for</span> verification...</span><br><span class="line">Cleaning up challenges</span><br><span class="line"></span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">new certificate deployed without reload, fullchain is</span><br><span class="line">/etc/letsencrypt/live/liluyang.me/fullchain.pem</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line"></span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">** DRY RUN: simulating <span class="string">'certbot renew'</span> close to cert expiry</span><br><span class="line">**          (The <span class="built_in">test</span> certificates below have not been saved.)</span><br><span class="line"></span><br><span class="line">Congratulations, all renewals succeeded. The following certs have been renewed:</span><br><span class="line">  /etc/letsencrypt/live/liluyang.me/fullchain.pem (success)</span><br><span class="line">** DRY RUN: simulating <span class="string">'certbot renew'</span> close to cert expiry</span><br><span class="line">**          (The <span class="built_in">test</span> certificates above have not been saved.)</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line"></span><br><span class="line">IMPORTANT NOTES:</span><br><span class="line"> - Your account credentials have been saved <span class="keyword">in</span> your Certbot</span><br><span class="line">   configuration directory at /etc/letsencrypt. You should make a</span><br><span class="line">   secure backup of this folder now. This configuration directory will</span><br><span class="line">   also contain certificates and private keys obtained by Certbot so</span><br><span class="line">   making regular backups of this folder is ideal.</span><br></pre></td></tr></table></figure></p>
<h3 id="手动执行自动续订"><a href="#手动执行自动续订" class="headerlink" title="手动执行自动续订"></a>手动执行自动续订</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot renew -v</span><br></pre></td></tr></table></figure>
<h3 id="开启自动续订"><a href="#开启自动续订" class="headerlink" title="开启自动续订"></a>开启自动续订</h3><p>自动续订也可以用 <code>certbot</code> 来实现，自动续订之后会更新 <code>pem</code> 文件到 <code>/etc/letsencrypt/live/example.com/</code> 。如果你的 <code>nginx</code> 配置没有直接指向 <code>/etc/letsencrypt/live/example.com/</code> 文件夹，请记得将 <code>pem</code> 文件夹拷贝到你的配置文件夹中</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certbot renew --quiet --no-self-upgrade</span><br></pre></td></tr></table></figure>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><p><a href="http://www.ruanyifeng.com/blog/2018/02/nginx-docker.html" target="_blank" rel="noopener">《Nginx 容器教程》 BY 阮一峰</a></p>
</li>
<li><p><a href="http://www.ruanyifeng.com/blog/2016/08/migrate-from-http-to-https.html" target="_blank" rel="noopener">《https 教程参考链接》 BY 阮一峰</a></p>
</li>
<li><p><a href="https://github.com/Snailclimb/JavaGuide/blob/master/docs/network/HTTPS%E4%B8%AD%E7%9A%84TLS.md" target="_blank" rel="noopener">《HTTPS中的TLS》</a></p>
</li>
<li><p><a href="https://certbot.eff.org/lets-encrypt/debianstretch-nginx" target="_blank" rel="noopener">《Let’s Encrypt 证书生成工具Certbot》 BY Let’s Encrypt官方</a></p>
</li>
<li><p><a href="https://bitmingw.com/2017/02/02/letsencrypt-tutorial/" target="_blank" rel="noopener">《Let’s Encrypt 入门教程》</a></p>
</li>
<li><p><a href="http://diamondfsd.com/lets-encrytp-hand-https/" target="_blank" rel="noopener">《Let’s Encrypt 使用教程，免费的SSL证书，让你的网站拥抱 HTTPS》</a></p>
</li>
<li><p><a href="https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/" target="_blank" rel="noopener">《HTTPS 简介及使用官方工具 Certbot 配置 Let’s Encrypt SSL 安全证书详细教程》</a></p>
</li>
<li><p><a href="https://program-think.blogspot.com/2010/02/introduce-digital-certificate-and-ca.html" target="_blank" rel="noopener">《数字证书及 CA 的扫盲介绍和工作原理》</a></p>
</li>
</ul>
<p>~</p>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/03/20190403_HTTPS 配置教程/" data-id="cjxdbkbyl007hu0ayo006if6q" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTPS/">HTTPS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/博客/">博客</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/计算机网络/">计算机网络</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/08/20190408_Jenkins 忘记密码怎么办？/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Jenkins 忘记密码怎么办？
        
      </div>
    </a>
  
  
    <a href="/2019/04/02/20190402_假如地球突然失去氧气五秒钟会怎样？/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">假如地球突然失去氧气五秒钟会怎样？</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/">FFmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTPS/">HTTPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leetcode/">Leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot/">Spring Boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/假如（WhatIF）/">假如（WhatIF）</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/双指针/">双指针</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图床/">图床</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串/">字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/持续集成/">持续集成</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学/">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数组/">数组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/栈/">栈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/水题/">水题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科普/">科普</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/第三方登录/">第三方登录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/简历/">简历</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/缓存/">缓存</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视频/">视频</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机网络/">计算机网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 13.75px;">Docker</a> <a href="/tags/FFmpeg/" style="font-size: 10px;">FFmpeg</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/Hexo/" style="font-size: 12.5px;">Hexo</a> <a href="/tags/Java/" style="font-size: 12.5px;">Java</a> <a href="/tags/Jenkins/" style="font-size: 12.5px;">Jenkins</a> <a href="/tags/Kubernetes/" style="font-size: 11.25px;">Kubernetes</a> <a href="/tags/Leetcode/" style="font-size: 20px;">Leetcode</a> <a href="/tags/Linux/" style="font-size: 12.5px;">Linux</a> <a href="/tags/Mysql/" style="font-size: 11.25px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 12.5px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 12.5px;">Redis</a> <a href="/tags/Spring-Boot/" style="font-size: 10px;">Spring Boot</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/Windows/" style="font-size: 11.25px;">Windows</a> <a href="/tags/假如（WhatIF）/" style="font-size: 11.25px;">假如（WhatIF）</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/动态规划/" style="font-size: 12.5px;">动态规划</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/双指针/" style="font-size: 11.25px;">双指针</a> <a href="/tags/图床/" style="font-size: 10px;">图床</a> <a href="/tags/字符串/" style="font-size: 13.75px;">字符串</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/持续集成/" style="font-size: 10px;">持续集成</a> <a href="/tags/数学/" style="font-size: 13.75px;">数学</a> <a href="/tags/数据库/" style="font-size: 18.75px;">数据库</a> <a href="/tags/数组/" style="font-size: 11.25px;">数组</a> <a href="/tags/栈/" style="font-size: 11.25px;">栈</a> <a href="/tags/水题/" style="font-size: 16.25px;">水题</a> <a href="/tags/科普/" style="font-size: 11.25px;">科普</a> <a href="/tags/第三方登录/" style="font-size: 10px;">第三方登录</a> <a href="/tags/简历/" style="font-size: 10px;">简历</a> <a href="/tags/算法/" style="font-size: 17.5px;">算法</a> <a href="/tags/缓存/" style="font-size: 10px;">缓存</a> <a href="/tags/视频/" style="font-size: 15px;">视频</a> <a href="/tags/计算机网络/" style="font-size: 11.25px;">计算机网络</a> <a href="/tags/设计模式/" style="font-size: 11.25px;">设计模式</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/05/15/20190420_Ubuntu 下 Redis 的常用命令/">Ubuntu 下 Redis 的常用命令</a>
          </li>
        
          <li>
            <a href="/2019/04/20/20190420_leetcode1025/">leetcode1025. 除数博弈</a>
          </li>
        
          <li>
            <a href="/2019/04/17/20190417_leetcode303/">leetcode303. 区域和检索 - 数组不可变</a>
          </li>
        
          <li>
            <a href="/2019/04/16/20190416_观察者模式学习笔记/">观察者模式学习笔记</a>
          </li>
        
          <li>
            <a href="/2019/04/15/20190415_leetcode121/">leetcode121. 买卖股票的最佳时机</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 面条先生<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>