---
title: leetcode183. 从不订购的客户
date: 2019-03-22 11:11:43
tags:
    - Leetcode
    - 数据库
---

问题连接：[183. 从不订购的客户](https://leetcode-cn.com/problems/customers-who-never-order/)

#### Question: 

某网站包含两个表，Customers 表和 Orders 表。编写一个 SQL 查询，找出所有从不订购任何东西的客户。

Customers 表：
```
+----+-------+
| Id | Name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
```
Orders 表：

```
+----+------------+
| Id | CustomerId |
+----+------------+
| 1  | 3          |
| 2  | 1          |
+----+------------+
```
例如给定上述表格，你的查询应返回：

```
+-----------+
| Customers |
+-----------+
| Henry     |
| Max       |
+-----------+
```

#### Answer: 

```sql
-- 使用not in查询
-- 查询客户表，并且用户 id 从没有在 order 中产生关联关系作为查询条件即可获得返回结果 
-- select name as customers from customers where customers.id not in (select customerId from orders)

-- 使用not exist查询
-- not exist的查询过程如下
-- setp00 select customers（先执行外查询）
-- step01 select orders（执行子查询，检测子查询是否可以返回行，则返回true or false的标记位）
-- step02 根据 id 比较 两张表，将子查询的每一行设置 true or false 的标记位
-- | 1  | Joe   | true
-- | 2  | Henry | false
-- | 3  | Sam   | true
-- | 4  | Max   | false
-- step03 true为exist，false为not exist，则根据not exist的规则返回外查询中的查询条件返回henry, max

select name as customers from customers

where not exists

(select customerId from orders where customers.id = orders.customerId)
```

~~~

***