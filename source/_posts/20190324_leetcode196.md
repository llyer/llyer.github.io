---
title: leetcode196. 删除重复的电子邮箱
date: 2019-03-24 13:11:43
tags:
    - Leetcode
    - 数据库
---

问题连接：[176. 第二高的薪水](https://leetcode-cn.com/problems/second-highest-salary/)

#### Question: 

编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary） 。

```
+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
```

例如上述 Employee 表，SQL查询应该返回 200 作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回 null。

```
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
```

#### SQL 架构：

```
Create table If Not Exists Employee (Id int, Salary int) Truncate table Employee
insert into Employee (Id, Salary) values ('1', '100')
insert into Employee (Id, Salary) values ('2', '200')
insert into Employee (Id, Salary) values ('3', '300')
```

#### Answer: 

```sql
-- 并集查询，查询时，生成 m * n 条记录，其中 m 和 n 分别为两个表的记录个数，效率非常低，不建议使用

-- 查询要删除的记录
-- SELECT * FROM person p1, person p2 where p1.email = p2.email and p1.id > p2.id 

-- 删除一个表时不需要指定从那个表删除记录
-- DELETE FROM person WHERE id = 3

-- 但是如果是两个表，要显式的指定要删除那个表
DELETE p1 FROM person p1, person p2 where p1.email = p2.email and p1.id > p2.id 
```

~~~

***