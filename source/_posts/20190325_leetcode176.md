---
title: leetcode176. 第二高的薪水
date: 2019-03-25 13:11:43
tags:
    - Leetcode
    - 数据库
---

问题连接：[196. 删除重复的电子邮箱](https://leetcode-cn.com/problems/delete-duplicate-emails/)

#### Question: 

编写一个 SQL 查询，来删除 Person 表中所有重复的电子邮箱，重复的邮箱里只保留 Id 最小的那个。

```
+----+------------------+
| Id | Email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
```

Id 是这个表的主键。

例如，在运行你的查询语句之后，上面的 Person 表应返回以下几行:

```
+----+------------------+
| Id | Email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
```

#### Answer: 

```sql
-- 1. 查询第二高的薪水，说明查询结果要按照薪水降序排列 order by salary desc

-- 2. 因为只是查询第二高说明是要分页查询，查询排序中的一个，所以要用到  limit 1 offset 0

-- 3. 表中如果只有一条记录，则查询结果为空，但是题目要求的结果是返回 null，所有加上一个ifnull判断，如果返回为空，那么返回null

SELECT ifnull((
		SELECT DISTINCT salary AS SecondHighestSalary
		FROM employee
		ORDER BY salary DESC
		LIMIT 1, 1
	), NULL) AS SecondHighestSalary
```

~~~

***