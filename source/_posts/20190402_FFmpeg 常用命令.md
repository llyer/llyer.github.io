---
title: FFmpeg 常用命令
date: 2019-04-02 14:24:47
updated: 2019-4-10 11:18:50
tags:
        - FFmpeg
        - 视频
        - 工具
---

[FFmpeg](https://zh.wikipedia.org/wiki/FFmpeg) 是一个自由软件，可以运行音频和视频多种格式的录影、转换、流功能，包含了libavcodec——这是一个用于多个项目中音频和视频的解码器库，以及libavformat——一个音频与视频格式转换库。

“FFmpeg”这个单词中的“FF”指的是“Fast Forward（快速前进）”。有些新手写信给“FFmpeg”的项目负责人，询问FF是不是代表“Fast Free”或者“Fast Fourier”等意思，“FFmpeg”的项目负责人回信说：“Just for the record, the original meaning of "FF" in FFmpeg is "Fast Forward"...”

#### 动图转图片序列

逐帧输出，将视频的所有帧输出到制定文件夹，例如一秒 `24` 帧，视频一共 `10` 秒，输出后就是 `24*10=240` 帧
```sh
ffmpeg -i input.gif /images/image_%04d.png
```

#### 动图转视频

参考教程地址：[点我](https://unix.stackexchange.com/questions/40638/how-to-do-i-convert-an-animated-gif-to-an-mp4-or-mv4-on-the-command-line)
```sh

ffmpeg -i animated.gif -movflags faststart -pix_fmt yuv420p -vf "scale=trunc(iw/2)*2:trunc(ih/2)*2" video.mp4
```

#### 视频，GIF添加水印
```sh
ffmpeg  -i input.gif -vf "drawtext=fontfile=simhei.ttf: text='你的水印':x=600:y=330:fontsize=18:fontcolor=yellow:shadowy=2" manu.gif
```

#### 视频转图片序列
```sh
ffmpeg -i "cut01.mp4" ./cut01/image_%04d.png
```

#### 合并音频和视频
```sh
ffmpeg -i video.mp4 -i audio.m4a -acodec copy -vcodec copy output.mp4
```

#### 截取视频中的一段
```sh
ffmpeg  -i ./input.mp4 -vcodec copy -acodec copy -ss 00:00:10 -to 00:00:15 ./cut01.mp4 -y
```
参考链接：https://www.cnblogs.com/wainiwann/p/6972954.html
        


#### 裁剪视频
裁剪视频的大小，一定要指定码率

```sh
ffmpeg -i cutout1.mp4 -strict -2 -vf crop=400:720:400:0 -b 10M out2.mp4
```

#### 图片序列转视频
第一个 -r 指的是帧数，-b 指的是码率  -s 是分辨率

```sh
FFMPEG -r 10 -i ./image_%04d.jpg -s 640x640 -b 10M -vcodec mpeg4 ./video.mp4

FFMPEG -r 10 
        -i ./image_%04d.jpg 
        -s 640x640 
        -b 10M 
        -vcodec mpeg4 ./video.mp4
```
#### 制作模糊背景

算法的机制应该是高斯模糊，但是作者还没有详细的检查对应的原理，能用就行。

此代码适合在横屏视频和竖屏视频之间的转换，并且填充一部分模糊的背景，不至于让视频有黑边而显的突兀
参数说明，根据源视频生成两个视频，再将两个视频叠加，生成的高斯模糊的视频在原视频的下方同步播放，这样就实现了模糊式的视频视频

<!-- ffmpeg -i input.mp4 -vf "split[a][b];[a]scale=664:664,boxblur=10:5[1];[b]scale=(iw*374)/ih:374[2];[1][2]overlay=(W-w)/2:y=(H-h)/2" 2.mp4
 -->

```sh
# -i 视频输出  -vf 参数转换  output.mp4 输出视频
# -vf 内部参数说明：生成 1,2 两个视频。第一个视频是模糊背景， scale调整尺寸大小，第二个原视频不要动，overlay 合成并且调整坐标
ffmpeg -i input.mp4 -vf "split[a][b];[a]scale=1920:1920,boxblur=10:5[1];[b]scale=(iw*1080)/ih:1080[2];[1][2]overlay=(W-w)/2:y=(H-h)/2" output.mp4
```

**效果如下：**

原视频截图：

![](https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190410_ffmpeg_00.png)

生成模糊背景之后的视频截图：

![](https://blog-1251468774.cos.ap-shanghai.myqcloud.com/20190410_ffmpeg_01.png)

# 参考链接 

- [ffmpeg 官方教程](https://ffmpeg.org/ffmpeg.html)

- [偶遇FFmpeg(二)——常用命令](https://www.jianshu.com/p/c5bfd55a312d)

~

***